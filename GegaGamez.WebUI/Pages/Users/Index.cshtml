@page "{id:int}"
@model IndexModel
@{
    AuthDisplayHelper authHelper = new(User);

    bool logedIn = authHelper.IsAuthenticated;

    bool authorized = authHelper.IsAuthorized(Model.UserProfile!.Id);

    if (authorized)
    {
        ViewData ["profile"] = true;
    }
}
<article id="user-profile">
    <img id="user-avatar-big" class="img-standard circle border-primary" src="/img/avatar.png" alt="User image" />
    <div id="info-and-buttons-container" class="flex-container">
        <section id="user-text-info" class="text-info-block">
            <h2>
               @Model.UserProfile.Username
            </h2>

            <span class="font-secondary">
                @Model.UserProfile.Country?.Name
            </span>

            <span>
                @Model.UserProfile.Name
            </span>

            <span>
                @Model.UserProfile.About
            </span>
        </section>

        <section id="profile-buttons" class="btn-group">
            @if(logedIn && authorized)
            {
                <button onclick="showEditProfileModal()" type="button" class="btn-contrast rounded">Edit profile</button>
            }
        </section>
    </div>

    <section id="default-collections-section" class="">
        <h2>Default Collections</h2>

        <div class="collections-container">

            @foreach(var defaultCollection in Model.DefaultCollections)
            {
                // render collection
                <div class="game-collection-item default-collection-item">
                    <a href="/Users/@(Model.UserProfile.Id)/@(defaultCollection.Type.Name)" class="game-collection-card user-collection-card">
                        <img class="collection-preview" src="https://static.wikia.nocookie.net/the-antijimi/images/d/d6/Naked_Snake.png/revision/latest?cb=20200316155909" alt="Last game adde to collection" />
                        <span class="collection-name">@defaultCollection.Type.Name</span>
                    </a>
                    <section class="game-collection-actions">
                        <button type="button" class="btn-contrast btn-icon btn-remove-collection"><i class="fa-solid fa-trash"></i></button>
                    </section>
                </div>
            }

        </div>
    </section>

    <section id="user-collections-section">
        <h2>Custom Collections</h2>

        <div class="collections-container">

            @foreach(var userCollection in Model.UserCollections)
            {
                // render collections
                <div class="game-collection-item user-collection-item">
                    <a asp-page="/Collections/Index" class="game-collection-card user-collection-card">
                        <img class="collection-preview" src="https://static.wikia.nocookie.net/the-antijimi/images/d/d6/Naked_Snake.png/revision/latest?cb=20200316155909" alt="Last game adde to collection" />
                        <span class="collection-name">@userCollection.Name</span>
                    </a>

                    <section class="game-collection-actions">
                        <button type="button" class="btn-contrast btn-icon btn-remove-collection"><i class="fa-solid fa-trash"></i></button>
                    </section>
                </div>
            }
         
        </div>
    </section>
</article>

<form asp-page-handler="UpdateProfile" method="post" id="edit-profile-modal" class="popup-interactive bg-secondary border-primary">
        <input hidden asp-for=UpdateModel.Id value=@Model.UserProfile.Id />
        <h3 class="font-contrast">Something</h3>
        <section class="main-something">
            <div class="input-block">
                <label>Choose your country</label>
                <select asp-items=@Model.Countries asp-for=UpdateModel.CountryId>

                </select>
            </div>

            <div class="input-block">
                <label>Say a few things about yourself</label>
                <textarea asp-for=UpdateModel.About title="About" placeholder="About yourself"></textarea>
            </div>
        </section>
        <section class="popup-actions">
            <button type="submit" class="borderless">Update profile</button>
            <button type="button" onclick="hideEditProfileModal()" class="btn-contrast rounded">Cancel</button>
        </section>
    </form>